{
  "info": {
    "name": "HR Management API",
    "_postman_id": "d2d9f5e1-4e6d-45d8-8b59-a6b5b6d207a4",
    "description": "Auth + employee list + bulk attendance check-in + dashboard overview.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1) Login (HR Admin)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{adminEmail}}\",\n  \"password\": \"{{adminPassword}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/auth/login",
          "host": ["{{baseUrl}}"],
          "path": ["auth", "login"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('login status is 201/200', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});",
              "const json = pm.response.json();",
              "if (json.accessToken) pm.collectionVariables.set('accessToken', json.accessToken);",
              "if (json.user?.role) pm.collectionVariables.set('currentRole', json.user.role);",
              "if (json.user?.employeeId) pm.collectionVariables.set('currentEmployeeId', json.user.employeeId);"
            ]
          }
        }
      ]
    },
    {
      "name": "2) List Employees (HR Admin)",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{accessToken}}" },
          { "key": "x-role", "value": "hr_admin" }
        ],
        "url": {
          "raw": "{{baseUrl}}/core-hr/employees",
          "host": ["{{baseUrl}}"],
          "path": ["core-hr", "employees"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('employees response ok', function () {",
              "  pm.expect(pm.response.code).to.eql(200);",
              "});",
              "const arr = pm.response.json();",
              "pm.test('employee list is array', function () {",
              "  pm.expect(Array.isArray(arr)).to.eql(true);",
              "});",
              "if (Array.isArray(arr) && arr.length > 0) {",
              "  pm.collectionVariables.set('emp1', arr[0]?.id || '');",
              "  pm.collectionVariables.set('emp2', arr[1]?.id || '');",
              "  pm.collectionVariables.set('emp3', arr[2]?.id || '');",
              "  pm.collectionVariables.set('emp4', arr[3]?.id || '');",
              "}"
            ]
          }
        }
      ]
    },
    {
      "name": "3) Bulk Check-In (Top 4 Employees)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{accessToken}}" },
          { "key": "x-role", "value": "hr_admin" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"entries\": [\n    { \"employeeId\": \"{{emp1}}\", \"time\": \"08:58\" },\n    { \"employeeId\": \"{{emp2}}\", \"time\": \"09:07\" },\n    { \"employeeId\": \"{{emp3}}\", \"time\": \"09:12\" },\n    { \"employeeId\": \"{{emp4}}\", \"time\": \"08:55\" }\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/attendance/admin/bulk-check-in",
          "host": ["{{baseUrl}}"],
          "path": ["attendance", "admin", "bulk-check-in"]
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "['emp1','emp2','emp3','emp4'].forEach((k) => {",
              "  const v = pm.collectionVariables.get(k);",
              "  if (!v) console.warn(`Missing ${k}; run List Employees first.`);",
              "});"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('bulk check-in success', function () {",
              "  pm.expect([200, 201]).to.include(pm.response.code);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "4) Dashboard Overview",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{accessToken}}" },
          { "key": "x-role", "value": "hr_admin" }
        ],
        "url": {
          "raw": "{{baseUrl}}/dashboard/overview",
          "host": ["{{baseUrl}}"],
          "path": ["dashboard", "overview"]
        }
      }
    }
  ],
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:4000" },
    { "key": "adminEmail", "value": "datainventdev@gmail.com" },
    { "key": "adminPassword", "value": "supweg-9vakke-gydfAh" },
    { "key": "accessToken", "value": "" },
    { "key": "emp1", "value": "" },
    { "key": "emp2", "value": "" },
    { "key": "emp3", "value": "" },
    { "key": "emp4", "value": "" },
    { "key": "currentRole", "value": "" },
    { "key": "currentEmployeeId", "value": "" }
  ]
}
